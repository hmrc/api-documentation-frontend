@*
 * Copyright 2021 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.apidocumentation.models._
@import uk.gov.hmrc.apidocumentation.controllers
@import partials.pagination

@import uk.gov.hmrc.apidocumentation.views.html.include._

@this(apiMain: apiMain)

@(pageAttributes: PageAttributes)(implicit request: Request[AnyContent], messagesProvider: MessagesProvider)

@apiMain(pageAttributes) {


    <h1 class="govuk-heading-xl">Testing in the sandbox</h1>

    <nav role="navigation" aria-labelledby="onThisPage">
        <h2 id="onThisPage" class="visually-hidden">On this page</h2>
        <ul class="govuk-list">
            <li>Getting started</li>
            <li><a class="govuk-link" href="@controllers.routes.TestingPagesController.testUsersDataStatefulBehaviourPage()">Test users, test data and stateful behaviour</a></li>
        </ul>
    </nav>

    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible" aria-hidden="true">

    <h2 class="govuk-heading-l">Getting started</h2>
    <p class="govuk-body">Use our sandbox environment to test your application against our RESTful APIs before going live.
        This environment does not support our XML APIs which must be tested as explained in the
        <a class="govuk-link" href="https://www.gov.uk/government/publications/basic-guide-for-software-developers">Basic guide for software developers</a>.
    </p>
    <h3 class="govuk-heading-m">1. Add an application</h3>
    <p class="govuk-body"><a class="govuk-link" href="https://developer.service.hmrc.gov.uk/developer/applications/add/sandbox">Add a sandbox application</a> to use for testing.</p>
    <p class="govuk-body">Sandbox applications that have not made an API call for 12 months will be deleted.</p>
    <h3 class="govuk-heading-m">2. Subscribe to APIs</h3>
    <p class="govuk-body">You must subscribe to APIs before your application can access them. Subscribe on the manage API subscriptions page.</p>
    <h3 class="govuk-heading-m">3. Get sandbox credentials</h3>
    <p class="govuk-body">Get these from the manage credentials page. They are only valid for the sandbox environment.</p>
    <h3 class="govuk-heading-m">4. Configure your application for sandbox</h3>
    <p class="govuk-body">Configure your application to make authorisation and API calls to sandbox endpoints using your sandbox credentials and the base URL <code class="code--slim">https://test-api.service.hmrc.gov.uk</code>.</p>
    <h3 class="govuk-heading-m">5. Create test users and other test data</h3>
    <p class="govuk-body">To test <a class="govuk-link" href="@controllers.routes.AuthorisationController.authorisationUserRestrictedEndpointsPage()">user-restricted endpoints</a>, you need to create <a class="govuk-link" href="@controllers.routes.TestingPagesController.testUsersDataStatefulBehaviourPage()">test users and potentially other test data</a>.</p>
    <h3 class="govuk-heading-m">6. Test the authorisation process</h3>
    <p class="govuk-body">If you’re testing <a class="govuk-link" href="@controllers.routes.AuthorisationController.authorisationUserRestrictedEndpointsPage()">user-restricted endpoints</a>, trigger the authorisation process from your application:</p>
    <ul class="govuk-list govuk-list--bullet">
        <li>Sign in with the credentials for the test user you created. Note that sandbox doesn’t include 2-step verification or identity checks.</li>
        <li>Complete the journey by granting authority to your application.</li>
        <li>We will return control back to your application, which should then obtain an OAuth token for use in subsequent API calls.</li>
    </ul>
    <p class="govuk-body">Remember to test failure cases by selecting “Do not grant authority” after signing in.</p>
    <h3 class="govuk-heading-m">7. Test API calls</h3>
    <p class="govuk-body">Use your application to make calls to our sandbox APIs.</p>
    <p class="govuk-body">Remember to test the error scenarios mentioned in the API documentation.</p>

    @pagination(next = Some(Pagination("Test users, test data and stateful behaviour", controllers.routes.TestingPagesController.testUsersDataStatefulBehaviourPage().url)))

}
